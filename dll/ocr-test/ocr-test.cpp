#include <windows.h>
#include <vector>
#include <iostream>

typedef std::string(*SendDetectRequestFunc)(const std::string url, const std::vector<std::vector<uint8_t>>& pixelData, const wchar_t* rightKey);

int main() {
    HMODULE hDll = LoadLibrary(L"ocr.dll");
    if (!hDll) {
        std::cerr << "Could not load DLL" << std::endl;
        return -1;
    }

    SendDetectRequestFunc SendDetectRequest = (SendDetectRequestFunc)GetProcAddress(hDll, "SendDetectRequest");
    if (!SendDetectRequest) {
        std::cerr << "Could not locate the function" << std::endl;
        FreeLibrary(hDll);
        return -1;
    }

    std::vector<std::vector<uint8_t>> pixel(33, std::vector<uint8_t>(193, 0));
	
    {
		pixel[7][16] = 1;
		pixel[8][15] = 1;
		pixel[9][14] = 1;
		pixel[10][13] = 1;
		pixel[11][12] = 1;
		pixel[12][11] = 1;
		pixel[13][10] = 1;
		pixel[14][10] = 1;
		pixel[15][11] = 1;
		pixel[16][12] = 1;
		pixel[17][13] = 1;
		pixel[18][13] = 1;
		pixel[19][13] = 1;
		pixel[20][13] = 1;
		pixel[21][13] = 1;
		pixel[21][12] = 1;
		pixel[21][11] = 1;
		pixel[21][10] = 1;
		pixel[21][9] = 1;
		pixel[22][9] = 1;
		pixel[20][14] = 1;
		pixel[20][15] = 1;
		pixel[19][16] = 1;
		pixel[19][16] = 1;
		pixel[11][18] = 1;
		pixel[11][17] = 1;
		pixel[12][17] = 1;
		pixel[12][16] = 1;
		pixel[13][13] = 1;
		pixel[13][14] = 1;
		pixel[13][15] = 1;
		pixel[13][16] = 1;
		pixel[14][16] = 1;
		pixel[15][16] = 1;
		pixel[16][16] = 1;
		pixel[17][16] = 1;
		pixel[17][17] = 1;
		pixel[18][17] = 1;
		pixel[18][19] = 1;
		pixel[17][20] = 1;
		pixel[17][21] = 1;
		pixel[16][22] = 1;
		pixel[16][22] = 1;
		pixel[25][14] = 1;
		pixel[24][14] = 1;
		pixel[23][14] = 1;
		pixel[25][13] = 1;
		pixel[26][13] = 1;
		pixel[27][12] = 1;
		pixel[21][20] = 1;
		pixel[21][21] = 1;
		pixel[21][22] = 1;
		pixel[21][23] = 1;
		pixel[21][24] = 1;
		pixel[21][25] = 1;
		pixel[21][26] = 1;
		pixel[21][27] = 1;
		pixel[21][28] = 1;
		pixel[21][29] = 1;
		pixel[22][29] = 1;
		pixel[22][30] = 1;
		pixel[22][31] = 1;
    }

	{
		pixel[8][46] = 1;
		pixel[8][47] = 1;
		pixel[8][48] = 1;
		pixel[8][49] = 1;
		pixel[8][50] = 1;
		pixel[8][51] = 1;
		pixel[7][52] = 1;
		pixel[7][53] = 1;
		pixel[7][54] = 1;
		pixel[7][55] = 1;
		pixel[7][56] = 1;
		pixel[8][57] = 1;
		pixel[8][58] = 1;
		pixel[8][59] = 1;
		pixel[8][60] = 1;
		pixel[8][61] = 1;
		pixel[8][62] = 1;
		pixel[8][63] = 1;
		pixel[8][64] = 1;
		pixel[8][65] = 1;
		pixel[9][56] = 1;
		pixel[10][56] = 1;
		pixel[11][55] = 1;
		pixel[12][55] = 1;
		pixel[13][54] = 1;
		pixel[13][53] = 1;
		pixel[14][53] = 1;
		pixel[15][52] = 1;
		pixel[15][51] = 1;
		pixel[16][50] = 1;
		pixel[16][49] = 1;
		pixel[16][48] = 1;
		pixel[14][56] = 1;
		pixel[15][56] = 1;
		pixel[31][56] = 1;
		pixel[13][57] = 1;
		pixel[13][58] = 1;
		pixel[14][58] = 1;
		pixel[15][59] = 1;
		pixel[16][60] = 1;
		pixel[16][61] = 1;
		pixel[17][61] = 1;
		pixel[17][62] = 1;
		pixel[18][62] = 1;
		pixel[18][63] = 1;
		pixel[18][56] = 1;
		pixel[16][56] = 1;
		pixel[17][56] = 1;
		pixel[18][56] = 1;
		pixel[19][56] = 1;
		pixel[20][56] = 1;
		pixel[21][56] = 1;
		pixel[22][56] = 1;
		pixel[23][56] = 1;
		pixel[24][56] = 1;
		pixel[25][56] = 1;
		pixel[26][56] = 1;
		pixel[27][56] = 1;
		pixel[28][56] = 1;
		pixel[29][56] = 1;
		pixel[30][56] = 1;
		pixel[31][56] = 1;
	}

	{
		pixel[11][80] = 1;
		pixel[12][80] = 1;
		pixel[13][80] = 1;
		pixel[14][80] = 1;
		pixel[15][80] = 1;
		pixel[16][80] = 1;
		pixel[17][80] = 1;
		pixel[18][80] = 1;
		pixel[19][80] = 1;
		pixel[20][80] = 1;
		pixel[21][80] = 1;
		pixel[22][80] = 1;
		pixel[23][77] = 1;
		pixel[23][78] = 1;
		pixel[23][79] = 1;
		pixel[23][80] = 1;
		pixel[23][81] = 1;
		pixel[23][82] = 1;
		pixel[23][83] = 1;
		pixel[23][84] = 1;
		pixel[23][85] = 1;
		pixel[23][86] = 1;
		pixel[23][87] = 1;
		pixel[23][88] = 1;
		pixel[14][81] = 1;
		pixel[14][82] = 1;
		pixel[14][83] = 1;
		pixel[13][84] = 1;
		pixel[13][85] = 1;
		pixel[13][86] = 1;
		pixel[13][87] = 1;
		pixel[13][88] = 1;
		pixel[13][89] = 1;
		pixel[13][90] = 1;
		pixel[14][87] = 1;
		pixel[15][87] = 1;
		pixel[16][87] = 1;
		pixel[17][87] = 1;
		pixel[18][87] = 1;
		pixel[19][87] = 1;
		pixel[19][86] = 1;
		pixel[20][86] = 1;
		pixel[21][86] = 1;
		pixel[15][90] = 1;
		pixel[16][90] = 1;
		pixel[17][90] = 1;
		pixel[18][90] = 1;
		pixel[19][90] = 1;
		pixel[20][90] = 1;
		pixel[21][90] = 1;
		pixel[21][89] = 1;
		pixel[22][89] = 1;
		pixel[22][90] = 1;
		pixel[22][91] = 1;
		pixel[22][92] = 1;
		pixel[22][93] = 1;
		pixel[22][94] = 1;
		pixel[22][95] = 1;
		pixel[21][94] = 1;
		pixel[12][95] = 1;
		pixel[13][95] = 1;
		pixel[14][95] = 1;
		pixel[15][95] = 1;
		pixel[16][95] = 1;
		pixel[17][95] = 1;
		pixel[18][95] = 1;
		pixel[19][95] = 1;
		pixel[21][95] = 1;
		pixel[21][97] = 1;
		pixel[21][98] = 1;
		pixel[21][99] = 1;
		pixel[21][100] = 1;
		pixel[21][101] = 1;
		pixel[21][102] = 1;
		pixel[11][81] = 1;
		pixel[11][82] = 1;
		pixel[10][82] = 1;
		pixel[10][83] = 1;
		pixel[10][84] = 1;
		pixel[9][85] = 1 ;
		pixel[9][86] = 1 ;
		pixel[9][87] = 1 ;
		pixel[8][88] = 1 ;
		pixel[8][89] = 1 ;
		pixel[8][90] = 1 ;
		pixel[7][91] = 1 ;
		pixel[7][92] = 1 ;
		pixel[7][93] = 1 ;
		pixel[7][94] = 1 ;
		pixel[12][91] = 1;
		pixel[12][92] = 1;
		pixel[12][93] = 1;
		pixel[12][94] = 1;
		pixel[12][95] = 1;
	}

	{
		pixel[9][117] = 1;
		pixel[9][118] = 1;
		pixel[9][119] = 1;
		pixel[9][120] = 1;
		pixel[9][121] = 1;
		pixel[9][122] = 1;
		pixel[9][123] = 1;
		pixel[9][124] = 1;
		pixel[9][125] = 1;
		pixel[9][126] = 1;
		pixel[9][127] = 1;
		pixel[9][128] = 1;
		pixel[9][129] = 1;
		pixel[9][130] = 1;
		pixel[9][131] = 1;
		pixel[9][132] = 1;
		pixel[9][133] = 1;
		pixel[9][134] = 1;
		pixel[10][134] = 1;
		pixel[11][134] = 1;
		pixel[12][134] = 1;
		pixel[13][134] = 1;
		pixel[14][134] = 1;
		pixel[15][134] = 1;
		pixel[16][134] = 1;
		pixel[17][134] = 1;
		pixel[18][134] = 1;
		pixel[19][134] = 1;
		pixel[20][134] = 1;
		pixel[21][134] = 1;
		pixel[22][134] = 1;
		pixel[23][134] = 1;
		pixel[24][134] = 1;
		pixel[25][134] = 1;
		pixel[26][134] = 1;
		pixel[27][134] = 1;
		pixel[24][131] = 1;
		pixel[25][132] = 1;
		pixel[26][133] = 1;
		pixel[15][120] = 1;
		pixel[16][119] = 1;
		pixel[17][119] = 1;
		pixel[18][118] = 1;
		pixel[10][125] = 1;
		pixel[11][125] = 1;
		pixel[12][125] = 1;
		pixel[13][124] = 1;
		pixel[14][124] = 1;
		pixel[15][124] = 1;
		pixel[16][124] = 1;
		pixel[17][123] = 1;
		pixel[18][123] = 1;
		pixel[19][123] = 1;
		pixel[20][122] = 1;
		pixel[21][122] = 1;
		pixel[22][121] = 1;
		pixel[23][121] = 1;
		pixel[24][120] = 1;
		pixel[25][119] = 1;
		pixel[26][118] = 1;
		pixel[26][117] = 1;
		pixel[26][116] = 1;
	}

	std::wstring rightKey = L"b#a#d#e";

    std::string result = SendDetectRequest("http://localhost:9999", pixel, rightKey.c_str());
    std::cout << "Result: " << result << std::endl;

    FreeLibrary(hDll);
    return 0;
}